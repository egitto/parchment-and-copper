p = 37399584984398124931854301584930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249
g = 2
a = 83957930158391048329104375493285498324538914938249930158391048329104375493285498324538914938249243%p
# A = (g**a)%p
b = 2479301583910483291043754932854983245389149382499301583910483291043754932854983245389149382493894%p
# B = (g**b)%p
# s = (A**b)%p
# print(A,B,s)

def mod_exp(base,exp,mod):
  memoize = {}
  def mod_exp(base,exp,mod):
    if (base,exp,mod) in memoize.keys():
      return memoize[(base,exp,mod)]
    if exp < 2:
      v = (base**exp)%mod
      memoize[(base,exp,mod)] = v
      return v
    v = (mod_exp(base,exp//2,mod)**2)%mod
    if exp%2 == 1:
      v = (v*base)%mod
    memoize[(base,exp,mod)] = v
    return v
  v = mod_exp(base,exp,mod)
  print(len(memoize.keys()))
  return v


A = mod_exp(g,a,p)
B = mod_exp(g,b,p)
s = mod_exp(A,b,p)
print(A,B,s)